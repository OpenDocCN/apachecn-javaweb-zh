# 十一、答案

# 第一章

1.  企业 Java 微服务具有以下功能：

    *   它是用 Java 语言编写的。
    *   它可以使用任何 Java 框架。
    *   它可以使用任何 JavaAPI。
    *   它必须是企业级的：可靠、可用、可扩展、安全、健壮且性能优异。
    *   它必须满足[中列出的微服务架构的特性 https://martinfowler.com/microservices/](https://martinfowler.com/microservices/) ，具体如下：
        *   通过服务实现组件化
        *   围绕业务能力进行组织
        *   产品而非项目
        *   智能端点和哑管道
        *   分权治理
        *   分散数据管理
        *   基础设施自动化
        *   失效设计
        *   进化设计
2.  数字经济和数字转型这两个术语描述了四种不同力量的融合。。。

# 第二章

1.  MicroProfile社区的主要通信方式是他们的 Google 组，称为*Eclipse MicroProfile*。您可以通过向`microprofile@googlegroups.com`发送电子邮件向其发送消息。另一个让你的声音被听到的好方法是参加每两周一次的聚会电话。请查看 Google 日历文件，了解加入的确切日期、时间和会议信息。
2.  该会议作为一个论坛，讨论与会者提出的主题，并做出决策，从子项目状态和发布内容到发布日期和子项目创建批准。

3.  子项目（MicroProfile规范）负责人或一组负责人通常是手头主题的主题专家，并被指定为其促进者。需要注意的一个重要方面是，一个或多个工作组（或该问题的子项目）的负责人不会单枪匹马地塑造或决定规范的演变，也不会决定是否包含哪些能力。他们没有否决权或就其规格所作决定的最终决定权。通过分享想法、专业知识、过去的经验、对现有技术的分析和最佳实践，工作组将尽可能提出他们的最佳建议。
4.  在社区在MicroProfile Google 小组和/或MicroProfile Hangout call 中详细讨论了一个新想法，并确定值得进一步讨论后，社区决定为这个新想法创建一个工作组，以及一个或多个领导小组，他们通常是手头主题的专家，工作组将建立一个每周或两周一次的定期会议，会议记录在谷歌日历中。任何人都可以参加这些会议，但通常有一些核心人员作为主题专家参加这些会议。在几次会议后，工作组决定是否应将新功能提交MicroProfile挂起会议，以讨论其成为MicroProfile子项目的建议。在MicroProfile挂起会议上，子项目提案可能会被拒绝或接受。子项目的接受意味着它有效地满足了一种需求，从而丰富了规范，实现了为微服务体系结构优化企业 Java 的目标。正是在这个时刻，一个子项目成为了一个官方的MicroProfile API。一旦子项目成为MicroProfile API，则确定它是属于MicroProfile发布范围之外的独立子项目还是包含在MicroProfile发布范围内的子项目。
5.  Eclipse 微配置文件遵循一个时间盒式快速增量发布计划，它是公开的，并在 Eclipse 基金会 MyPrror 项目页面上列出。主要的 Eclipse MicroProfile版本，例如从 1.x 到 2.x，包括对MicroProfile API 的主要更新，这些更新可能会引入突破性的更改。次要发行版，即点发行版，包括小型 API 更新或使预定发行日期生效的新 API。目前，MicroProfile社区发布窗口在每年的 2 月、6 月和 11 月用于次要和/或主要发布。

6.  沙盒存储库是一个 GitHub 存储库，用于孵化想法和代码示例，这些想法和代码示例最终将转变为一个单独的存储库，为新规范做出贡献。任何人都可以打开 pull 请求，使用沙箱进行新想法的实验，共享代码和文档，这些都可以作为社区 Google 小组讨论的一部分，也可以作为工作组会议的一部分。
7.  在 MicroFile umbrella/平台版本之外发布子项目的原因是，它为社区和最终用户提供了一个利用和测试新技术的机会，从而在考虑将其纳入 umbrella 之前在实际应用中进行了验证。MicroProfile 项目鼓励新的子项目规范在考虑将其包含在伞式/平台版本之前，至少在伞式版本之外发布一个版本。
8.  Micropofile Starter 是一个示例源代码生成器，其目标是通过在 Maven 项目中生成工作示例代码，帮助开发人员快速开始使用和利用企业 Java 微服务社区驱动的开源规范 Eclipse Micropofile 的功能。

# 第三章

1.  配置属性的默认来源是环境变量、Java 系统属性和`META-INF`/`microprofile-config.properties`文件。
2.  您可以提供自定义 ConfigSource 实现，该实现将属性名称映射到自定义源中的值。
3.  字符串不是唯一受支持的类型，因为 MP Config 支持通过可插拔 SPI 进行类型转换，并且默认情况下提供多个默认转换。
4.  如果您已经给出了一个`defaultValue`，或者已经将属性作为`Optional<?>`值注入，则不需要为注入的属性提供值。
5.  可以使用接受字符串并返回复杂类型的自定义`Converter<?>`实现来处理复杂属性类型。
6.  在类中指定批注时。。。

# 第四章

1.  wire 格式在仅查看 HTTP 状态代码以确定 HC 状态的环境中不可用。
2.  MP-HC 响应可以使用`HealthCheckResponse#withData()`方法包含任意属性。
3.  您可以为每个服务创建一个 HealthCheck 实现，MP-HC 特性将逻辑地组合它们以生成一个整体状态响应。
4.  JWT 是一个 JSON Web 令牌，是一个 JSON 格式的对象，具有头、负载和签名组件。
5.  声明是来自 JWT 负载的单个命名值
6.  任何可以用 JSON 表示的东西都可以用在 JWT 中。
7.  对 JWT 进行身份验证的一个主要步骤是根据配置的公钥验证它是否通过 RS256 算法签名。
8.  您可以查看其他声明，这些组声明要进行检查以添加特定于应用的授权决策。

# 第五章

1.  分布式跟踪提供了端到端请求的微观视图，而度量则公开了单个组件的标量数值。
2.  分布式跟踪系统通常提供诸如根本原因和关键路径分析、上下文化日志记录、分布式上下文传播和服务依赖关系图等功能。
3.  自动跟踪的是 JAX-RS 服务器端点和 Rest 客户端。一些供应商还可以自动跟踪 JAX-RS 客户机。
4.  如果引发异常，则为每个 REST 请求`http.method`、`http.status_code`、`http.url`、`component`、`span.kind`和`error`添加这些标记。
5.  通过使用`@Traced`注释或注入示踪剂并创建。。。

# 第六章

1.  否：默认情况下，任何 REST 端点都将为其生成 OpenAPI，即使未使用任何 MP OpenAPI 注释。
2.  是：您可以选择使用尽可能多或尽可能少的 MP OpenAPI 注释来表示 microservice 中的其余端点。
3.  其概念是预先定义端点的预期契约，并将其封装在 OpenAPI 文档中，这些文档可以与微服务捆绑在一起。
4.  否：您只需要知道请求和响应的格式，然后就可以创建自己的类型安全接口。
5.  通过使用`.../mp-rest/url`MP 配置设置，其中`...`是类型安全接口的接口名称或传递给`RegisterRestClient`注释的 configKey。
6.  一种方法是注册一个`ClientHeadersFactory`实现。另一个是在`org.eclipse.microprofile.rest.client.propagateHeaders`MP Config 属性中列出标题。

# 第七章

1.  在撰写本文时，Eclipse MicroProfile有八种实现，它们都是开源的。它们是 Thorntail、OpenLiberty、ApacheTomee、Payara Micro、吊床、KumuluzEE、Launcher 和 Helidon。Quarkus 也是最新的参赛者。
2.  应用服务器是 JavaEE 应用的容器。应用汇编器只包含应用所需的功能，而不要求应用服务器启动并运行，通常会生成一个可执行的 JAR。应用汇编器可以生成一个 uberjar，一个自包含的可运行 JAR 文件，或者应用 jar 及其运行时依赖项位于子目录中，例如，附带的`lib`或`libs`子目录。。。

# 第八章

1.  在本书和本章中，我们已经看到了许多 MP 配置设置影响应用和 MP 功能的示例。
2.  只要您提供的路径存在，您就应该能够看到一个成功的健康检查，其中包含有关该路径的信息。
3.  它显示有关 KeyClope 服务器的信息。如果 KeyClope 停止，则显示错误。
4.  将找不到它，因为度量是在第一次请求时延迟生成的。
5.  待定。
6.  对于不安全的方法，行为应该类似。对于安全方法，Swagger UI 调用失败。
7.  您将看到错误响应。
8.  这就是编码的 MP-JWT。您可以在 curl 命令中将其用作*授权：Bearer。。。*要替换的标题值。。。使用 Access Base64 令牌字段中的字符串。

# 第九章

1.  MicroProfile反应式消息传递是通过连接器处理消息源的一个很好的选择，特别是在消息源以高频率生成消息的情况下，异步处理消息最有意义。
2.  MicroProfile上下文传播最支持MicroProfile反应流操作符和MicroProfile反应消息传递，因为它允许跨各种类型的工作单元传播传统上与当前线程关联的上下文。
3.  当前支持反应式编程的规范有MicroProfile反应流操作符、MicroProfile反应式消息传递和MicroProfile上下文传播。
4.  在写这篇文章的时候，这些项目。。。

# 第十章

1.  Eclipse MicroProfile提供了使用企业 Java 开发微服务的最佳方法之一。反过来，使用容器作为部署单元开发的微服务提供了在云中和本地开发高度分布式系统的最佳方法之一，即云本地应用。因此，基于MicroProfile的微服务促进了云本地应用的开发。
2.  云本机应用开发有两个互补的方面或组件：应用服务和基础设施服务。应用服务加快了云本地应用业务逻辑的开发，基础设施服务加快了其交付和部署。这两个方面是云本地应用开发的补充和组成部分。

3.  云本地应用开发是一种构建和运行应用的方法，它充分利用基于四个关键原则的云计算模型：a）基于服务的体系结构（迷你服务、微服务、SOA 服务等）；b） API 驱动的服务间通信方法；c） 基于容器的底层基础设施；d）DevOps 过程。架构和通信方面与云本地应用的开发关注点相关，而基础架构和流程方面与它们的交付/部署相关。Eclipse Micropofile 与这些原则相关，因为它支持微服务的实现，微服务可以是使用容器作为底层基础设施的体系结构的一部分，其中微服务使用其 API 相互通信，并使用 DevOps 流程开发。
4.  以下是 Eclipse Micropofile 如何为八个步骤中的每一个做出贡献，以指导您的云本机应用之旅：
    1.  发展 DevOps 文化和实践：“通过接受 DevOps 的原则和文化价值观并围绕这些价值观组织您的组织，利用新技术、更快的方法和更紧密的协作。”尽管这是一个与组织和流程相关的步骤，Eclipse，作为微服务规范，微服务可以很好地适应文化和流程的这种适应性，因为微服务由于其特性而密切支持 DevOps 流程。
    2.  使用 fast monolith 加速现有应用：“通过迁移到现代的、基于容器的平台来加速现有应用，并将单片应用拆分为微服务或小型服务，以获得额外的效率提升。”Eclipse Micropofile 在将您的 monolith 拆分为微服务时可以提供很大帮助。当您识别整块中的有界上下文时，考虑使用 Eclipse 微配置文件来实现实现每个有界上下文逻辑的每一个微服务。

5.  12 因素应用是一种开发人员在设计和实现微服务和应用时可以遵循的方法，与实现它们所使用的编程语言或框架无关。开发人员可以使用 EclipseMicroFile 框架来使用 12 因素应用实现微服务。12 因素应用和 Eclipse 文件不是相互排斥的，而是相辅相成的。
6.  大多数（如果不是全部的话）市场上的 FaaS 产品都支持 Java。因此，开发人员可以在 Eclipse MicroProfile的众多实现中的一个实现中编写函数体，这些实现都是用 Java 编写的。Eclipse Micropofile 的易用性和丰富功能，再加上 FaaS 平台的简单性，可以极大地提高开发人员更快地为业务提供价值的能力。此外，Quarkus 等技术实现了 Eclipse MicroProfile，占用内存少，启动时间快，是 FaaS 的理想运行时。
7.  在跨云部署中使用 Eclipse 文件时，需要考虑以下事项：

    *   需要使用云环境提供的任何 DNS 支持来配置云环境和内部部署环境之间的通信路由。
    *   配置 MicroProfile OpenTracing 以支持跨云环境捕获跟踪。

8.  在多云环境中进行分布式跟踪可能是一项挑战。我们希望实现与单一云环境相同的目标，即在请求通过每个云内和跨每个云的服务时，可视化与请求关联的单一端到端跟踪，但在处理不同的上下文传播格式和以不同的格式存储每个云的跟踪数据时，可能会面临复杂的问题。第一个挑战是确保跟踪在不同的云环境中继续进行。这是一个问题，因为在编写本文时，没有广泛采用或标准化的跟踪上下文格式。通常，每个跟踪系统都使用不同的头和格式来传播跟踪上下文。第二个挑战，即使在同质跟踪环境中，也是可视化来自多云环境的跟踪数据。这可能会有问题，因为每个云中的跟踪数据可能存储在不同的数据库中或以不同的格式存储。这可以通过将数据复制到单个统一存储或通过适当的数据格式调整按需在系统之间发送丢失的跟踪数据来克服。
9.  Istio 或 LinkerD 等服务网格在 Kubernetes 之上的平台级别提供发现、路由和容错领域的服务。这些服务中的一些也可以在文件中找到。当你将一个 MyPrror 应用部署到这样一个服务网格中时，你需要考虑如果你想使用 MyPrror 的版本或者 Mesh 文件中的一个版本，那么这里最容易受到影响的 MyPrimple 特性是容错，特别是重试逻辑。