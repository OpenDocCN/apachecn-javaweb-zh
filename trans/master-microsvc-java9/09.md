# 最佳做法和共同原则

在您为获得开发微服务示例项目的经验而付出了所有艰苦努力之后，您一定想知道如何避免常见错误并改进开发基于微服务的产品和服务的整个过程。我们可以遵循这些原则或指南来简化开发微服务的过程，并避免/减少潜在的限制。在本章中，我们将重点介绍这些关键概念。

本章分为以下三个部分：

*   概述和心态
*   最佳做法和原则
*   微服务框架和工具

# 概述和心态

您可以在新的和现有的产品和服务上实现基于微服务的设计。与从零开始开发和设计新系统比对现有系统进行更改更容易的信念相反，每种方法都有各自的挑战和优势。

例如，由于没有针对新产品或服务的现有系统设计，因此您可以自由灵活地设计系统，而无需考虑其影响。但是，对于一个新系统，您不清楚其功能和系统需求，因为这些需求随着时间的推移而逐渐成熟和成形。另一方面，对于成熟的产品和服务，您拥有功能和系统需求的详细知识和信息。尽管如此，您仍面临一个挑战，即如何减轻设计变更带来的影响风险。因此，当涉及到将生产系统从单片升级到微服务时，您需要比从头开始构建系统时做得更好。

经验丰富且成功的软件设计专家和架构师总是评估利弊，并采取谨慎的方法对现有的实时系统进行任何更改。人们不应该仅仅因为现有的实时系统设计可能很酷或很时髦就对其进行更改。因此，如果您想将现有生产系统的设计更新为 MicroService，则需要在进行此调用之前评估所有利弊。

我相信单片系统为升级到成功的基于微服务的设计提供了一个很好的平台。显然，我们这里不是在讨论成本。您对现有系统和功能有充分的了解，这使您能够划分现有系统，并基于功能以及这些功能如何相互交互来构建微服务。此外，如果您的单片产品已经以某种方式模块化，那么通过公开 API 而不是**应用程序二进制接口**（**ABI**）来直接转换微服务可能是实现微服务体系结构的最简单方法。一个成功的基于微服务的系统更依赖于微服务及其交互协议。

话虽如此，但这并不意味着如果你从头开始，就不能拥有一个成功的基于微服务的系统。但是，建议启动一个基于单片设计的新项目，让您能够透视和理解系统和功能。它允许您快速发现瓶颈，并引导您识别任何可以使用微服务开发的潜在功能。在这里，我们没有讨论项目的规模，这是另一个重要因素。我们将在下一节讨论这一点。

在当今的云时代和敏捷开发世界中，从做出任何更改到实现更改需要一个小时。在当今竞争激烈的环境中，每个组织都希望拥有快速向用户提供功能的优势。持续开发、集成和部署是生产交付过程的一部分，这是一个完全自动化的过程。

如果您提供的是基于云的产品或服务，那么它更有意义。然后，基于微服务的系统使团队能够灵活响应，以解决任何问题或向用户提供新功能。

因此，在您呼吁从头开始新的基于微服务的项目或计划将现有单片系统的设计升级为基于微服务的系统之前，您需要评估所有的利弊。你必须倾听并理解团队中分享的不同想法和观点，你需要采取谨慎的态度。

最后，我想与大家分享一个成功的生产系统所需要的更好的流程和有效的系统的重要性。拥有一个基于微服务的系统并不能保证一个成功的生产系统，而一个单一的应用程序并不意味着在今天的时代你不能拥有一个成功的生产系统。基于微服务的云视频租赁服务 Netflix 和单一电子商务平台 Etsy 都是成功的现场制作系统的例子（参见本章后面*参考文献*一节中有趣的 Twitter 讨论链接）。因此，流程和敏捷性也是成功生产系统的关键。

# 最佳做法和原则

正如我们从第一章了解到的，微服务是实现**面向服务架构**（**SOA**的轻量级风格。除此之外，微服务没有严格定义，这使您能够根据需要灵活地按照自己的方式开发微服务。同时，您需要确保遵循一些标准实践和原则，以使您的工作更轻松，并成功实现基于微服务的体系结构。

# 纳米服务、尺寸和单片

项目中的每个微服务都应该很小，并执行一个功能或特性（例如，用户管理），独立地足以独立执行该功能。

Mike Gancarz（设计 X Window 系统的成员）的以下两段话定义了 Unix 哲学的最高准则之一，也适用于微服务范式：

“小就是美。”

“让每个程序都做好一件事。”

现在，在当今时代，当你有一个框架（例如 Finangle）来减少**行代码**（**LOC**）时，我们如何定义大小？此外，许多现代语言，如 Python 和 Erlang，都没有那么冗长。这使得您很难决定是否要使此代码成为微服务。

显然，您可以为少量 LOC 实现微服务；这实际上不是一种微服务，而是一种纳米服务。

Arnon Rotem Gal Oz 对纳米服务的定义如下：

Nanoservice 是一种反模式，其中服务粒度太细。Nanoservice 是一种开销（通信、维护等）超过其效用的服务

因此，基于功能设计微服务总是有意义的。域驱动设计使得在域级别定义功能更加容易。

如前所述，在决定是否实施微服务或确定项目所需的微服务数量时，项目的大小是一个关键因素。在一个简单的小项目中，使用单片架构是有意义的。例如，根据我们在[第 3 章](03.html)、*领域驱动设计*中学习到的领域设计，您将对您的功能需求有一个清晰的了解，并且可以利用事实来划分各种功能或特征之间的界限。例如，在我们已经实现的示例项目（online table reservation system；OTRS）中，如果您不想将 API 公开给客户，或者不想将其用作 SaaS，那么使用单片设计开发同一项目是非常容易的，或者，在打电话之前，您需要评估很多类似的参数。

当需要时，您可以稍后将单片项目迁移到微服务设计。因此，您应该以模块化的方式开发单片项目，并在每个级别和层上实现松散耦合，并确保不同功能和特性之间存在预定义的接触点和边界，这一点很重要。此外，您的数据源（如 DB）也应进行相应的设计。即使您不打算迁移到基于微服务的系统，它也会使 bug 修复和增强更容易实现。

注意以上几点可以缓解迁移到 MicroService 时可能遇到的任何困难。

一般来说，大型或复杂的项目应该使用基于微服务的体系结构进行开发，因为它提供了许多优势，如前几章所述。

我甚至建议将您的初始项目开发为单片；一旦您对项目功能和项目复杂性有了更好的理解，就可以将其迁移到微服务。理想情况下，开发的初始原型应该为您提供功能边界，使您能够做出正确的选择。

# 持续集成和部署

您必须有一个持续的集成和部署过程。它使您能够更快地交付更改并尽早检测错误。因此，每个服务都应该有自己的集成和部署过程。此外，它必须是自动化的。还有很多工具，比如说，Jenon，Teamkins，被广泛使用。它可以帮助您自动化构建过程，从而尽早发现构建失败，特别是当您将更改与主线集成（如任何发布分支/标记或主分支）时。

您还可以将测试与每个自动化集成和部署过程集成。**集成测试**测试系统不同部分之间的交互，如两个接口（API 提供者和使用者）之间的交互，或系统中不同组件或模块之间的交互，如 DAO 和数据库之间的交互等。集成测试很重要，因为它测试模块之间的接口。首先单独测试各个模块。然后，执行集成测试以检查组合行为并验证需求是否正确实现。因此，在微服务中，集成测试是验证 API 的关键工具。我们将在下一节中详细介绍这一点。

最后，您可以在 CD（持续部署）计算机上看到更新的主线更改，该过程在其中部署构建。

这个过程并没有到此结束：您可以制作一个容器（如 Docker）并将其交给您的 WebOps 团队，或者有一个单独的过程将其交付到配置的位置或部署到 WebOps 阶段环境。从这里，一旦获得指定机构的批准，就可以直接将其部署到生产系统中。

# 系统/端到端测试自动化

测试是任何产品和服务交付中非常重要的一部分。您不希望向客户交付有缺陷的应用程序。早些时候，在瀑布模型流行的时候，一个组织在交付给客户之前通常需要 1 到 6 个月或更长的时间进行测试。近年来，在敏捷过程变得流行之后，自动化越来越受到重视。与之前的点测试类似，自动化也是强制性的。

无论您是否遵循**测试驱动开发**（**TDD**，我们都必须具备系统或端到端测试自动化。测试您的业务场景非常重要，端到端测试也是如此，测试可以从 REST 调用到数据库检查，或者从 UI 应用程序到数据库检查。

此外，如果您有公共 API，测试您的 API 也很重要。

这样做可以确保任何更改都不会破坏任何功能，并确保无缝、无缺陷的生产交付。正如上一节所讨论的，使用单元测试对每个模块进行隔离测试，以检查一切是否按预期工作，然后在不同模块之间执行集成测试，以检查预期的组合行为并验证需求，无论是否正确实现。集成测试之后，执行功能测试，以验证功能和特性需求。

所以，如果单元测试确保单个模块在隔离状态下工作良好，那么集成测试确保不同模块之间的交互按预期工作。如果单元测试工作正常，则意味着集成测试失败的机会将大大减少。类似地，集成测试确保功能测试可能成功。

假定总是更新所有类型的测试，无论是单元级测试还是端到端测试场景。

# 自我监测和记录

微服务应提供有关其自身及其所依赖的各种资源的状态的服务信息。服务信息表示统计信息，如处理请求的平均时间、最小时间和最大时间、成功和失败请求的数量、跟踪请求的能力、内存使用情况等。

Adrian Cockcroft 在 2015 年 Glue 大会（Glue Con）上强调了一些对监控微服务非常重要的实践。其中大多数适用于任何监控系统：

*   与收集、移动、存储和显示度量的代码相比，花更多时间在分析度量含义的代码上。这不仅有助于提高生产率，而且还为微调微服务和提高系统效率提供了重要参数。我们的想法是开发更多的分析工具，而不是开发更多的监控工具。
*   显示延迟的指标需要小于人类的注意广度。阿德里安说，这意味着不到 10 秒。
*   验证您的测量系统是否具有足够的精度和精密度。收集响应时间的直方图。
*   准确的数据使决策更快，并允许您进行微调，直到达到精度水平。他还建议，显示响应时间的最佳图表是直方图。
*   监控系统需要比被监控的系统更可用、更可扩展。
*   这份声明说明了一切：你不能依赖一个本身不稳定或不全天候可用的系统。
*   优化分布式、短暂、云本地、容器化的微服务。
*   将指标与模型相匹配，以了解关系。

监控是微服务体系结构的关键组件。根据项目规模，您可能有十几到几千个微服务（对于大型企业的大型项目来说是如此）。即使是为了扩展和高可用性，组织也会为每个微服务创建集群或负载平衡池/pod，甚至基于版本为每个微服务创建单独的池。最终，它增加了需要监视的资源数量，包括每个微服务实例。此外，重要的是你有一个适当的流程，这样无论什么时候出了问题，你都会立即知道，或者更好，在出问题之前提前收到警告通知。因此，有效和高效的监控对于构建和使用微服务体系结构至关重要。Netflix 使用 Netflix Atlas（实时运营监控，处理 12 亿个指标）、security Monkey（用于监控基于 AWS 的环境的安全）、Scumblr（情报收集工具）和 FIDO（用于分析事件和自动事件报告）等工具进行安全监控。

日志记录是微服务的另一个重要方面，不容忽视。有了有效的日志记录，一切都不同了。由于可能有 10 个或更多的微服务，管理日志记录是一项艰巨的任务。

对于我们的示例项目，我们使用了**映射的诊断上下文**（**MDC**）日志记录，这在某种程度上足以用于单个微服务日志记录。然而，我们也需要整个系统的日志记录，或者说中央日志记录。我们还需要日志的聚合统计信息。有一些工具可以完成这项工作，比如 Loggly 或 Logspout。

请求和生成的相关事件为您提供了请求的总体视图。对于任何事件和请求的跟踪，将事件和请求分别与服务 ID 和请求 ID 关联是很重要的。您还可以将事件的内容（如消息、严重性、类名等）与服务 ID 相关联。

# 每个微服务都有一个单独的数据存储

如果您还记得的话，您可以了解到的微服务最重要的特征是微服务与其他微服务（通常作为独立应用程序）隔离运行的方式。

遵循此规则，建议不要跨多个微服务使用同一数据库或任何其他数据存储。在大型项目中，您可能有不同的团队在同一个项目上工作，并且您希望能够灵活地为每个微服务选择最适合该微服务的数据库。

现在，这也带来了一些挑战。

例如，如果项目共享相同的数据库结构，则以下内容与可能在同一项目中使用不同微服务的团队相关。一个微服务中的更改可能会影响其他微服务模型。在这种情况下，其中一个的更改可能会影响依赖的微服务，因此您还需要更改依赖的模型结构。

为了解决这个问题，应该基于 API 驱动的平台开发微服务。每个微服务都会公开其 API，其他微服务可能会使用这些 API。因此，您还需要开发 API，这是集成不同微服务所必需的。

类似地，由于不同的数据存储，实际项目数据也分布在多个数据存储中，这使得数据管理更加复杂，因为单独的存储系统更容易失去同步或变得不一致，外键也可能意外更改。要解决此问题，您需要使用**基础数据管理**（**MDM**工具。MDM 工具在后台运行，并在发现任何不一致时修复不一致。对于 OTRS 示例，它可能会检查存储预订请求 ID 的每个数据库，以验证所有数据库中是否存在相同的 ID（换句话说，在任何一个数据库中都没有丢失或额外的 ID）。市场上可用的 MDM 工具包括 Informatica、IBM MDM Advance Edition、Oracle Siebel UCM、Postgres（主流复制）、mariadb（主/主配置）等。

如果现有产品都不符合您的要求，或者您对任何专有产品都不感兴趣，那么您可以编写自己的产品。目前，API 驱动的开发和平台降低了这种复杂性；因此，微服务应该与 API 平台一起开发是很重要的。

# 交易边界

我们在[第 3 章](03.html)、*领域驱动设计*中介绍了领域驱动设计概念。如果你还没有完全掌握它，请回顾一下，因为它让你对国家有了一个纵向的理解。由于我们专注于基于微服务的设计，因此我们有了一个系统体系，其中每个微服务代表一个系统。在这种环境下，在任何给定的时间点找到整个系统的状态是非常具有挑战性的。如果您熟悉分布式应用程序，那么在状态方面，您可能会适应这种环境。

非常重要的是，要有适当的事务边界来描述在任何给定时间哪个微服务拥有一条消息。您需要一种可以参与事务、事务路由、错误处理程序、幂等消费者和补偿操作的方法或流程。确保跨异构系统的事务性行为并非易事，但有一些工具可以为您完成这项工作。

例如，Camel 具有强大的事务性功能，可以帮助开发人员轻松创建具有事务性行为的服务。

# 微服务框架和工具

最好不要重新发明轮子。因此，我们希望探索哪些工具已经可用，并提供平台、框架和功能，使微服务开发和部署更容易。

在本书中，我们广泛使用了 SpringCloud，原因是相同的：它提供了使微服务开发变得非常简单所需的所有工具和平台。春云使用网飞**开源软件**（**OSS**）。让我们来探索一下 Netflix OSS——一个完整的软件包。

我还简要介绍了每个工具将如何帮助构建良好的微服务体系结构。

# Netflix 开源软件（OSS）

Netflix OSS 中心是基于 Java 的微服务开源项目中最受欢迎和使用最广泛的开源软件。世界上最成功的视频租赁服务依赖于它。Netflix 拥有超过 4000 万用户，在全球使用。Netflix 是一个纯基于云的解决方案，基于微服务架构开发。你可以说，每当有人谈论微服务时，我想到的第一个名字就是 Netflix。让我们讨论一下它提供的各种工具。在开发示例 OTRS 应用程序时，我们已经讨论了其中的许多问题。然而，有一些我们还没有探讨。在这里，我们将只介绍每个工具的概述，而不是详细介绍。它将使您全面了解微服务体系结构的实际特征及其在云计算中的使用。

# 建造星云

Netflix Nebula 是 Gradle 插件的集合，使用 Gradle（一种类似 Maven 的构建工具）可以使您的微服务构建更加容易。对于我们的示例项目，我们使用了 Maven，因此在本书中我们没有机会探索星云。然而，探索它会很有趣。对于开发人员来说，Nebula 最重要的功能是消除 Gradle 构建文件中的样板代码，这使开发人员能够专注于编码。

拥有一个良好的构建环境，特别是 CI/CD（持续集成和持续部署），是微服务开发和与敏捷开发保持一致的必要条件。Netflix Nebula 使您的构建更简单、更高效。

# 部署和交付-带胺化剂的 Spinnaker

构建完成后，您希望将该构建移动到**Amazon Web Services**（**AWS**）EC2。Aminator 以**亚马逊机器映像**（**AMI**的形式创建并打包构建的映像。Spinnaker 然后将这些 AMI 部署到 AWS。

Spinnaker 是一个连续交付平台，用于以高速高效的方式发布代码更改。Spinnaker 还支持其他云服务，如 Google 计算机引擎和 cloud Foundry。

如果您想将最新的微服务构建部署到云环境（如 EC2），Spinnaker 和 Aminator 将帮助您以自主的方式实现这一点。

# 服务注册和发现-尤里卡

正如我们在本书中探讨的那样，Eureka 提供了一种负责微服务注册和发现的服务。除此之外，Eureka 还用于中间层（承载不同微服务的进程）的负载平衡。Netflix 还使用 Eureka 以及其他工具（如 Cassandra 或 memcached）来增强其整体可用性。

服务注册和发现是微服务体系结构的必要条件。尤里卡就是为了这个目的。请参考[第 4 章](04.html)、*实现微服务*，了解更多关于尤里卡的信息。

# 服务通讯-功能区

如果没有进程间或服务通信，微服务体系结构将毫无用处。功能区应用程序提供了此功能。Ribbon 与 Eureka 合作实现负载平衡，与 Hystrix 合作实现容错或断路器操作。

Ribbon 还支持 TCP 和 UDP 协议，除了 HTTP。它在异步和反应模型中提供这些协议支持。它还提供缓存和批处理功能。

由于您的项目中将有许多微服务，因此需要一种使用进程间或服务通信处理信息的方法。Netflix 为此提供了 Ribbon 工具。

# 断路器-Hystrix

Hystrix 工具用于断路器操作，即延迟和容错。因此，Hystrix 停止级联故障。Hystrix 执行实时操作以监控服务和属性更改，并支持并发性。

断路器或容错对于任何项目都是一个重要的概念，包括微服务。一个微服务的故障不应使整个系统停止运行；为了防止这种情况发生，并在发生故障时向客户提供有意义的信息，Netflix Hystrix 的工作就是这样。

# 边缘（代理）服务器-Zuul

Zuul 是一个边缘服务器或代理服务器，用于处理外部应用程序的请求，如 UI 客户端、Android/iOS 应用程序或产品或服务提供的 API 的任何第三方消费者。从概念上讲，它是通向外部应用程序的大门。

Zuul 允许动态路由和监视请求。它还执行安全操作，如身份验证。它可以识别每个资源的身份验证需求，并拒绝任何不满足这些需求的请求。

微服务需要边缘服务器或 API 网关。Netflix Zuul 提供此功能。更多信息请参见[第 5 章](05.html)、*部署和测试、*。

# 业务监测-Atlas

Atlas 是一种业务监测工具，提供关于维度时间序列数据的近实时信息。它捕获操作智能，提供系统内当前发生的情况。它具有内存数据存储功能，允许它非常快速地收集和报告大量度量。目前，它为 Netflix 处理 13 亿个指标。

Atlas 是一个可扩展的工具。这就是为什么它现在可以处理 13 亿个指标，而几年前只有 100 万个。Atlas 不仅在读取数据方面提供了可伸缩性，而且还将其作为 graph 请求的一部分进行聚合。

Atlas 使用 Netflix 观众库记录维度时间序列数据。

一旦您在云环境中部署了微服务，您就需要有一个监控系统来跟踪和监控所有的微服务。Netflix Atlas 为您完成这项工作。

# 可靠性监测服务——猿猴陆军

在云中，没有一个组件可以保证 100%的正常运行时间。因此，成功的微服务架构需要在单个云组件出现故障时使整个系统可用。Netflix 开发了一个名为 Simian Army 的工具来避免系统故障。Simian Army 保持云环境的安全、可靠和高可用性。为了实现高可用性和安全性，它使用云中的各种服务（猴子）来产生各种故障，检测异常情况，并测试云中抵御这些挑战的能力。
它使用以下服务（猴子），这些服务取自 Netflix 博客：

*   **混沌猴**：混沌猴是一种识别系统组并随机终止组中一个系统的服务。该服务以受控的时间和间隔运行。“混沌猴子”只在工作时间运行，目的是让工程师保持警觉并能够做出反应。
*   **看门人猴**：看门人猴是一项在 AWS 云中运行的服务，它寻找未使用的资源进行清理。它可以扩展到其他云提供商和云资源。服务时间表是可配置的。看门人猴子通过对资源应用一组规则来确定该资源是否应该是清理候选资源。如果任何规则确定该资源是清理候选资源，则“看门人猴子”会标记该资源并安排清理时间。对于例外情况，如果您希望在“看门人猴子”删除资源之前将未使用的资源保留更长时间，则该资源的所有者将在清理时间之前收到可配置天数的通知。
*   **一致性猴子**：一致性猴子是一种在 AWS 云中运行的服务，用于查找不符合最佳实践预定义规则的实例。它可以扩展到其他云提供商和云资源。服务时间表是可配置的。如果任何规则确定实例不符合要求，monkey 将向实例的所有者发送电子邮件通知。在某些特殊情况下，您可能希望忽略某些应用程序特定符合性规则的警告。
*   **安全猴子**：安全猴子监控 AWS 帐户中的策略更改和不安全配置警报。Security Monkey 的主要目的是安全性，尽管它也被证明是跟踪潜在问题的有用工具，因为它本质上是一个变更跟踪系统。

成功的微服务架构确保您的系统始终处于运行状态，单个云组件的故障不应导致整个系统故障。Simian 陆军使用多种服务来实现高可用性。

# AWS 资源监控-Edda

在云环境中，没有任何东西是静态的。例如，虚拟主机实例经常更改，IP 地址可能被各种应用程序重用，或者可能发生防火墙或相关更改。

Edda 是一项跟踪这些动态 AWS 资源的服务。Netflix 将其命名为 Edda（意思是*挪威神话故事*，因为它记录了云管理和部署的故事。Edda 使用 AWS API 轮询 AWS 资源并记录结果。这些记录允许您搜索并查看云随时间的变化。例如，如果 API 服务器的任何主机导致了任何问题，那么您需要找出该主机是什么以及由哪个团队负责。

以下是它提供的功能：

*   **动态查询**：Edda 提供 REST API，它支持矩阵参数，并提供字段选择器，仅允许您检索所需数据。
*   **历史记录**/c**变更**：Edda 维护所有 AWS 资源的历史记录。当您分析停机的原因和影响时，此信息有助于您。Edda 还可以提供有关资源的当前和历史信息的不同视图。它在编写时将信息存储在 MongoDB 中。
*   **配置**：Edda 支持多种配置选项。通常，您可以轮询来自多个帐户和多个区域的信息，并可以使用帐户和区域的组合来查询帐户点。同样，它为 AWS、Crawler、Elector 和 MongoDB 提供了不同的配置。

如果您使用 AWS 托管基于微服务的产品，那么 Edda 将用于监控 AWS 资源。

# 主机性能监控向量机研究

Vector 是一个静态 web 应用程序，在 web 浏览器中运行。它允许监控安装了**性能副驾驶**（**PCP**的主机的性能。Vector 支持 PCP 版本 3.10+。PCP 收集指标并将其提供给 Vector。

它根据需要提供高分辨率的正确度量。这有助于工程师了解系统的行为，并正确解决性能问题。

Vector 是一种监视工具，可帮助您监视远程主机的性能。

# 分布式配置管理-Archaius

Archaius 是一种分布式配置管理工具，允许您执行以下操作：

*   使用动态和类型化属性。
*   执行线程安全配置操作。
*   使用轮询框架检查属性更改。
*   在有序的配置层次结构中使用回调机制。
*   使用 JConsole 检查和执行属性上的操作，因为 Archaius 提供了 JMX MBean。
*   当您拥有基于微服务的产品时，需要一个好的配置管理工具。Archaius 帮助在分布式环境中配置不同类型的属性。

# apachemesos-Fenzo 的调度器

Fenzo 是用 Java 编写的 Apache Mesos 框架的调度程序库。ApacheMesos 框架匹配并将资源分配给挂起的任务。其主要特点如下：

*   它支持长时间运行的服务风格任务和批处理任务
*   它可以根据资源需求自动扩展执行主机集群
*   它支持可以根据需要创建的插件
*   您可以监视资源分配失败，这允许您调试根本原因

# 成本和云利用率-Ice

Ice 从成本和使用角度提供了云资源的鸟瞰图。它向不同的团队提供了有关调配的云资源分配的最新信息，为云资源的最佳利用增加了价值。

Ice 是一个圣杯项目。用户与 Ice UI 组件交互，该组件显示通过 Ice 阅读器组件发送的信息。读卡器从 Ice 处理器组件生成的数据中获取信息。Ice 处理器组件从详细的云计费文件读取数据信息，并将其转换为 Ice 阅读器组件可读的数据。

# 其他安全工具-Scumblr 和 FIDO

除了安全猴外，Netflix OSS 还使用了 Scumblr 和**全集成防御****操作**（**FIDO**工具。

为了跟踪并保护您的微服务免受常规威胁和攻击，您需要一种自动化的方法来保护和监视您的微服务。Netflix Scumblr 和 FIDO 为您完成这项工作。

# 人渣

Scumblr 是一个基于 Ruby-on-Rails 的 web 应用程序，它允许您定期执行搜索，并对识别的结果进行存储/执行操作。基本上，它收集情报，利用互联网范围的有针对性的搜索，找出具体的安全问题进行调查。

Scumblr 利用可工作流程的 gem，允许为不同类型的结果设置灵活的工作流。Scumblr 搜索使用名为**搜索提供者**的插件。它检查以下异常情况。由于它是可扩展的，因此您可以添加任意数量的：

*   泄露的凭据
*   漏洞/黑客攻击讨论
*   攻击讨论
*   安全相关社交媒体讨论

# 全面综合防御作战（FIDO）

FIDO 是用于分析事件和自动化事件响应的安全编排框架。它通过评估、评估和响应恶意软件来自动化事件响应过程。FIDO 的主要目的是处理评估来自当今安全堆栈的威胁以及由此产生的大量警报所需的大量手动工作。

作为一个协调平台，FIDO 可以大大减少检测、通知和响应网络攻击所需的手动工作量，从而使现有安全工具的使用更加高效和准确。有关更多信息，请参阅以下链接：

*   [https://github.com/Netflix/Fido](https://github.com/Netflix/Fido)
*   [https://github.com/Netflix](https://github.com/Netflix)

# 工具书类

*   单片（Etsy）与微服务（Netflix）推特讨论：[https://twitter.com/adrianco/status/441169921863860225](https://twitter.com/adrianco/status/441169921863860225)
*   Adrian Cockcroft*监控微服务和容器演示*：[http://www.slideshare.net/adriancockcroft/gluecon-monitoring-microservices-and-containers-a-challenge](http://www.slideshare.net/adriancockcroft/gluecon-monitoring-microservices-and-containers-a-challenge)
*   纳米服务反模式：[http://arnon.me/2014/03/services-microservices-nanoservices/](http://arnon.me/2014/03/services-microservices-nanoservices/%20)
*   用于微服务架构的 Apache Camel:[https://www.javacodegeeks.com/2014/09/apache-camel-for-micro%C2%ADservice-architectures.html](https://www.javacodegeeks.com/2014/09/apache-camel-for-micro%C2%ADservice-architectures.html)
*   团队城市：[https://www.jetbrains.com/teamcity/](https://www.jetbrains.com/teamcity/)
*   詹金斯：[https://jenkins-ci.org/](https://jenkins-ci.org/)
*   日志：[https://www.loggly.com/](https://www.loggly.com/)

# 总结

在本章中，我们探讨了最适合基于微服务的产品和服务的各种实践和原则。微服务架构是云环境的产物，与基于内部部署的单片系统相比，云环境被广泛使用。我们已经确定了一些与规模、敏捷性和测试相关的原则，这些原则对于成功的实施来说必须到位。

我们还概述了 Netflix OSS 用于成功实施基于微服务体系结构的产品和服务所需的各种关键功能的不同工具。Netflix 提供了视频租赁服务，成功地使用了相同的工具。

在下一章中，读者可能会遇到一些问题，他们可能会被这些问题所困扰。本章解释了微服务开发过程中遇到的常见问题及其解决方案。